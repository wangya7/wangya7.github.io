{"meta":{"title":"åŠè¾²","subtitle":"","description":"","author":"åŠè¾²","url":"http://bannong.wang","root":"/"},"pages":[],"posts":[{"title":"Dubbo-SPI&è‡ªé€‚åº”çš„æ‰©å±•æœºåˆ¶","slug":"Dubbo-SPI","date":"2020-12-03T13:51:44.000Z","updated":"2020-12-06T08:04:59.679Z","comments":true,"path":"2020/12/03/Dubbo-SPI/","link":"","permalink":"http://bannong.wang/2020/12/03/Dubbo-SPI/","excerpt":"","text":"å®˜æ–¹æ–‡æ¡£-SPI è‡ªé€‚åº”æ‹“å±• æ¨èé˜…è¯»å®˜æ–¹æ–‡æ¡£ JDKçš„SPIæ˜¯ä¸€ç§æœåŠ¡å‘ç°æœºåˆ¶ã€‚SPIå°†æ¥å£çš„å®ç°ç±»å…¨é™å®šåé…ç½®åœ¨æ–‡ä»¶ä¸­ï¼Œç”±æœåŠ¡åŠ è½½å™¨è¯»å–é…ç½®æ–‡ä»¶ï¼ŒåŠ è½½å®ç°ç±»ï¼Œè¿™æ ·å¯ä»¥åœ¨è¿è¡ŒæœŸé—´åŠ¨æ€çš„æ›¿æ¢å®ç°ç±»ã€‚é»˜è®¤çš„åŠ è½½è·¯å¾„ä¸ºMETA-INF/servicesï¼Œé€šè¿‡ServiceLoaderå®ç°åŠ è½½ã€‚Dubboå®ç°äº†å¢å¼ºçš„SPIæœºåˆ¶ã€‚Dubboçš„SPIç›¸å…³é€»è¾‘è¢«å°è£…åœ¨ExtensionLoaderä¸­ï¼Œé€šè¿‡å…¶åŠ è½½æŒ‡å®šçš„å®ç°ç±»ã€‚ç›¸æ¯”äºJDKçš„è·¯å¾„ï¼ŒDubboå°†é…ç½®æ–‡ä»¶æ”¾ç½®åœ¨META-INF/dubboä¸»è·¯å¾„ä¸‹ï¼ŒåŒæ—¶é‡‡ç”¨äº†é”®å€¼å¯¹çš„å½¢å¼ã€‚ ä¸»è¦åˆ†æ com.alibaba.dubbo.common.extension.ExtensionLoader Case-11234567891 @Test2 public void robotTest() &#123;3 ExtensionLoader&lt;Robot&gt; extensionLoader = ExtensionLoader.getExtensionLoader(Robot.class);4 Robot optimusPrime = extensionLoader.getExtension(\"optimusPrime\");5 optimusPrime.hi();67 Robot bumblebee = extensionLoader.getExtension(\"bumblebee\");8 bumblebee.hi();9 &#125; â‘ åˆå§‹åŒ–typeå¯¹åº”ExtensionLoaderå¯¹è±¡çš„objectFactoryæˆå‘˜å˜é‡1è¡Œä»£ç é€šè¿‡ ExtensionLoader.getExtensionLoader(Robot.class); è¿™è¡Œä»£ç å°±å¿…é¡»èµ°åˆ° new ExtensionLoader(type)ã€‚å…¶å®è¿™1è¡Œä»£ç å°±æ˜¯è¯´åˆå§‹åŒ– ExtensionFactory çš„å®ç°ï¼Œé»˜è®¤æ˜¯é¦–å…ˆåŠ è½½ ExtensionFactory.class ç„¶åè°ƒç”¨äº† getAdaptiveExtension()è·å–è‡ªé€‚åº”æ‹“å±• 1com.alibaba.dubbo.common.extension.ExtensionLoader.createAdaptiveExtension è¿™ä¸ªæ–¹æ³•å°±æ˜¯æ ¸å¿ƒéœ€è¦ç†è§£çš„å•¦ã€‚ è°ƒç”¨ getAdaptiveExtensionClass æ–¹æ³•è·å–è‡ªé€‚åº”æ‹“å±• Class å¯¹è±¡ é€šè¿‡åå°„è¿›è¡Œå®ä¾‹åŒ– è°ƒç”¨ injectExtension æ–¹æ³•å‘æ‹“å±•å®ä¾‹ä¸­æ³¨å…¥ä¾èµ–æ¯ä¸ªæ­¥éª¤é‡Œé¢åˆç»†åˆ†ï¼Œå°¤å…¶æ˜¯ç¬¬ä¸€æ­¥æ¯”è¾ƒç²¾å½©ï¼è¿™é‡Œé¢æŠŠç¬¬1æ­¥æ‹¿å‡ºæ¥è¯´ä¸€ä¸‹ã€‚1234567891011121314151617181920212223/** * 1. è°ƒç”¨ getExtensionClasses è·å–æ‰€æœ‰çš„æ‹“å±•ç±» * 2. æ£€æŸ¥ç¼“å­˜ï¼Œè‹¥ç¼“å­˜ä¸ä¸ºç©ºï¼Œåˆ™è¿”å›ç¼“å­˜ * 3. è‹¥ç¼“å­˜ä¸ºç©ºï¼Œåˆ™è°ƒç”¨ createAdaptiveExtensionClass åˆ›å»ºè‡ªé€‚åº”æ‹“å±•ç±» * * * é¦–å…ˆä»ç¬¬ä¸€ä¸ªé€»è¾‘è¯´èµ·ï¼ŒgetExtensionClasses è¿™ä¸ªæ–¹æ³•ç”¨äºè·å–æŸä¸ªæ¥å£çš„æ‰€æœ‰å®ç°ç±»ã€‚æ¯”å¦‚è¯¥æ–¹æ³•å¯ä»¥è·å– * Protocol æ¥å£çš„ DubboProtocolã€HttpProtocolã€InjvmProtocol ç­‰å®ç°ç±»ã€‚åœ¨è·å–å®ç°ç±»çš„è¿‡ç¨‹ä¸­ï¼Œ * å¦‚æœæŸä¸ªå®ç°ç±»è¢« Adaptive æ³¨è§£ä¿®é¥°äº†ï¼Œé‚£ä¹ˆè¯¥ç±»å°±ä¼šè¢«èµ‹å€¼ç»™ cachedAdaptiveClass å˜é‡ã€‚æ­¤æ—¶ï¼Œä¸Šé¢æ­¥ * éª¤ä¸­çš„ç¬¬äºŒæ­¥æ¡ä»¶æˆç«‹ï¼ˆç¼“å­˜ä¸ä¸ºç©ºï¼‰ï¼Œç›´æ¥è¿”å› cachedAdaptiveClass å³å¯ã€‚å¦‚æœæ‰€æœ‰çš„å®ç°ç±»å‡æœªè¢« * Adaptive æ³¨è§£ä¿®é¥°ï¼Œé‚£ä¹ˆæ‰§è¡Œç¬¬ä¸‰æ­¥é€»è¾‘ï¼Œåˆ›å»ºè‡ªé€‚åº”æ‹“å±•ç±»ã€‚ * * @return */private Class&lt;?&gt; getAdaptiveExtensionClass() &#123; // é€šè¿‡ SPI è·å–æ‰€æœ‰çš„æ‹“å±•ç±» getExtensionClasses(); if (cachedAdaptiveClass != null) &#123; return cachedAdaptiveClass; &#125; // åˆ›å»ºè‡ªé€‚åº”æ‹“å±•ç±» return cachedAdaptiveClass = createAdaptiveExtensionClass();&#125; è¿è¡Œä»£ç çš„æ—¶å€™ï¼Œä¼šå‘ç° ExtensionFactory åŒ…å«ä¸¤ä¸ªå®ç°ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªè¢« @Adaptive ä¿®é¥°çš„ AdaptiveExtensionFactoryï¼Œå…¶å®è¿™ä¸ªåœ¨getExtensionClasseså†…éƒ¨ä¼šåˆå§‹åŒ–èµ‹å€¼ç»™cachedAdaptiveClassï¼Œæ‰€ä»¥return cachedAdaptiveClass;ç›´æ¥è¿”å›å•¦ã€‚ â‘¡typeå¯¹åº”ExtensionLoaderå¯¹è±¡è·å–å¯¹åº”åç§°æ‰€å¯¹åº”çš„å®ç°ç±»1Robot optimusPrime = extensionLoader.getExtension(\"optimusPrime\"); è¿™ä¸ªå°±æ²¡æœ‰å•¥å­è¯´çš„å•¦ï¼Œè‡ªå·±è¿½ä»£ç  ç¬¬1ä¸ªCaseå°±æ˜¯é€šè¿‡Class.forNameåŠ è½½ã€‚ dubboé€šè¿‡è‡ªå®ç°çš„SPIæ¥å®ç°æ‰©å±•ï¼Œé…ç½®åˆ‡æ¢ã€‚ æ¯”å¦‚Protocolã€Clusterã€LoadBalance ç­‰ã€‚å½“æŸäº›æ‰©å±•ä¸æƒ³åœ¨æ¡†æ¶å¯åŠ¨æ—¶å€™åŠ è½½ï¼Œè€Œå¸Œæœ›æ‰©å±•æ–¹æ³•æ¡ç”¨çš„æ—¶å€™ï¼Œæ ¹æ®è¿è¡Œæ—¶å‚æ•°è¿›è¡ŒåŠ è½½ã€‚ â€”â€” æ‰©å±•æœªåŠ è½½ï¼Œéš¾é“å¯ä»¥ä½¿ç”¨æ‰©å±•çš„æ–¹æ³•ï¼Ÿdubboé€šè¿‡è‡ªé€‚åº”æ‹“å±•æœºåˆ¶å¾ˆå¥½çš„è§£å†³äº†ï¼Œdubbo ä¼šä¸ºæ‹“å±•æ¥å£ç”Ÿæˆå…·æœ‰ä»£ç†åŠŸèƒ½çš„ä»£ç ï¼Œç„¶åé€šè¿‡ javassist æˆ– jdk ç¼–è¯‘è¿™æ®µä»£ç å¾—åˆ°Classç±»ï¼Œæœ€åå†é€šè¿‡åå°„åˆ›å»ºä»£ç†ç±»ã€‚ @Adaptiveç”¨åœ¨ç±»ä¸Šé¢ï¼ŒåŸºæœ¬ä¸Šéƒ½æ˜¯æ˜¾ç°ç±»ä½¿ç”¨ï¼Œè¿™ä¸ªå®ç°ç±»å°±æ˜¯è¿™ä¸ªæ¥å£çš„é»˜è®¤å®ç°ï¼ˆæ¯”å¦‚ä¸Šé¢è¯´çš„ AdaptiveExtensionFactoryï¼‰ï¼›ä½†æ˜¯è¿™ä¸ªæ³¨è§£å¤šæ•°ä½¿ç”¨åœ¨æ–¹æ³•ä¸Šã€‚ Case-2ä¸‹é¢çš„æµ‹è¯•å¼•ç”¨com.alibaba.dubbo.common.extensionloader.ExtensionLoader_Adaptive_Test#test_getAdaptiveExtension_injectï¼Œä¸ºäº†æ–¹ä¾¿é˜…è¯»æºç ï¼Œåšäº†ç¨å¾®çš„ä¿®æ”¹ã€‚ 123456789101112131415161718192021 1 @Test 2 public void test_getAdaptiveExtension_inject() throws Exception &#123; 3 LogUtil.start(); 4 ExtensionLoader&lt;Ext6&gt; el = ExtensionLoader.getExtensionLoader(Ext6.class); 5 Ext6 ext = el.getAdaptiveExtension(); 6 7 URL url = new URL(\"p1\", \"1.2.3.4\", 1010, \"path1\"); 8 url = url.addParameters(\"ext6\", \"impl1\"); 910 String ans = ext.echo(url, \"ha\");11 assertEquals(\"Ext6Impl1-echo-Ext1Impl1-echo\", ans);1213 Assert.assertTrue(\"can not find error.\", LogUtil.checkNoError());14 LogUtil.stop();1516 // simple.ext å¯¹åº” SimpleExt17 url = url.addParameters(\"simple.ext\", \"impl2\");18 ans = ext.echo(url, \"ha\")19 assertEquals(\"Ext6Impl1-echo-Ext1Impl2-echo\", ans);2021 &#125; ç¬¬4è¡Œä»£ç å·²ç»åœ¨ä¸Šä¸ªcaseåˆ†æè¿‡å•¦ï¼Œç°åœ¨åˆ†æç¬¬5è¡Œè·å–ä¸€ä¸ªè‡ªé€‚åº”çš„æ‰©å±•ã€‚å…¶å®å…¥å£ä¹Ÿæ˜¯ç¬¬4è¡Œå¤„ç†ExtensionFactoryåŠ è½½éœ€è¦èµ°åˆ°çš„é€»è¾‘createAdaptiveExtensionï¼Œé‚£ä¹ˆä¸ºä»€ä¹ˆä¸Šé¢æ²¡æœ‰èµ°åˆ° createAdaptiveExtensionClassCode æ–¹æ³•å‘¢ï¼Ÿâ€”â€”â€”â€”æ˜¯å› ä¸ºExtensionFactoryçš„å®ç°ç±» AdaptiveExtensionFactory è¢« @Adaptive æ ‡æ³¨å•¦ã€‚ å› ä¸ºå…¶è¢«@Adaptiveæ ‡æ³¨ï¼Œåœ¨è·å–æ‰€æœ‰çš„æ‹“å±•ç±»getExtensionClassesé€»è¾‘ä¸­ä¼šèµ‹å€¼cachedAdaptiveClassæˆå‘˜å˜é‡ã€‚å…·ä½“çš„èµ‹å€¼é€»è¾‘åœ¨loadClassæ–¹æ³•ä¸­ã€‚ æˆ‘ä»¬å›å¤´çœ‹ä¸€ä¸‹åœ¨æ²¡æœ‰å®ç°ç±»è¢«@Adaptiveæ ‡æ³¨çš„æƒ…å†µä¸‹ï¼ŒDubboæ˜¯æ€åšè‡ªé€‚åº”æ‰©å±•çš„ï¼Ÿ ä¸‹é¢å†é‡æ¸©è¿™æ®µä»£ç å§ 1234567891011121314151617181920212223242526272829303132333435363738394041424344454647484950515253545556575859/** * 1. è°ƒç”¨ getAdaptiveExtensionClass æ–¹æ³•è·å–è‡ªé€‚åº”æ‹“å±• Class å¯¹è±¡ * 2. é€šè¿‡åå°„è¿›è¡Œå®ä¾‹åŒ– * 3. è°ƒç”¨ injectExtension æ–¹æ³•å‘æ‹“å±•å®ä¾‹ä¸­æ³¨å…¥ä¾èµ– * @return */@SuppressWarnings(\"unchecked\")private T createAdaptiveExtension() &#123; try &#123; return injectExtension((T) getAdaptiveExtensionClass().newInstance()); &#125; catch (Exception e) &#123; throw new IllegalStateException(\"Can not create adaptive extension \" + type + \", cause: \" + e.getMessage(), e); &#125;&#125;/** * 1. è°ƒç”¨ getExtensionClasses è·å–æ‰€æœ‰çš„æ‹“å±•ç±» * 2. æ£€æŸ¥ç¼“å­˜ï¼Œè‹¥ç¼“å­˜ä¸ä¸ºç©ºï¼Œåˆ™è¿”å›ç¼“å­˜ * 3. è‹¥ç¼“å­˜ä¸ºç©ºï¼Œåˆ™è°ƒç”¨ createAdaptiveExtensionClass åˆ›å»ºè‡ªé€‚åº”æ‹“å±•ç±» * * * é¦–å…ˆä»ç¬¬ä¸€ä¸ªé€»è¾‘è¯´èµ·ï¼ŒgetExtensionClasses è¿™ä¸ªæ–¹æ³•ç”¨äºè·å–æŸä¸ªæ¥å£çš„æ‰€æœ‰å®ç°ç±»ã€‚æ¯”å¦‚è¯¥æ–¹æ³•å¯ä»¥è·å– * Protocol æ¥å£çš„ DubboProtocolã€HttpProtocolã€InjvmProtocol ç­‰å®ç°ç±»ã€‚åœ¨è·å–å®ç°ç±»çš„è¿‡ç¨‹ä¸­ï¼Œ * å¦‚æœæŸä¸ªå®ç°ç±»è¢« Adaptive æ³¨è§£ä¿®é¥°äº†ï¼Œé‚£ä¹ˆè¯¥ç±»å°±ä¼šè¢«èµ‹å€¼ç»™ cachedAdaptiveClass å˜é‡ã€‚æ­¤æ—¶ï¼Œä¸Šé¢æ­¥ * éª¤ä¸­çš„ç¬¬äºŒæ­¥æ¡ä»¶æˆç«‹ï¼ˆç¼“å­˜ä¸ä¸ºç©ºï¼‰ï¼Œç›´æ¥è¿”å› cachedAdaptiveClass å³å¯ã€‚å¦‚æœæ‰€æœ‰çš„å®ç°ç±»å‡æœªè¢« * Adaptive æ³¨è§£ä¿®é¥°ï¼Œé‚£ä¹ˆæ‰§è¡Œç¬¬ä¸‰æ­¥é€»è¾‘ï¼Œåˆ›å»ºè‡ªé€‚åº”æ‹“å±•ç±»ã€‚ * * @return */private Class&lt;?&gt; getAdaptiveExtensionClass() &#123; // é€šè¿‡ SPI è·å–æ‰€æœ‰çš„æ‹“å±•ç±» getExtensionClasses(); if (cachedAdaptiveClass != null) &#123; return cachedAdaptiveClass; &#125; // åˆ›å»ºè‡ªé€‚åº”æ‹“å±•ç±» return cachedAdaptiveClass = createAdaptiveExtensionClass();&#125;private Class&lt;?&gt; createAdaptiveExtensionClass() &#123; // æ„å»ºè‡ªé€‚åº”æ‹“å±•ä»£ç  String code = createAdaptiveExtensionClassCode(); ClassLoader classLoader = findClassLoader(); // è·å–ç¼–è¯‘å™¨å®ç°ç±» com.alibaba.dubbo.common.compiler.Compiler compiler = ExtensionLoader.getExtensionLoader(com.alibaba.dubbo.common.compiler.Compiler.class).getAdaptiveExtension(); // ç¼–è¯‘ä»£ç ï¼Œç”Ÿæˆ Class return compiler.compile(code, classLoader);&#125;/** * å…¶å®å¾ˆç®€å• æ‰¾ä¸ªæ¡ˆä¾‹è·‘ä¸€ä¸‹ æ¯”å¦‚ com.alibaba.dubbo.remoting.Transporter æˆ–è€… com.alibaba.dubbo.rpc.Protocol * * é»˜è®¤ç”Ÿæˆä¸€ä¸ªä»£ç†ç±»çš„å­—ç¬¦ä¸²ç¼–ç  &#123;name&#125;$Adaptive * * @return */private String createAdaptiveExtensionClassCode() &#123; //...çœç•¥&#125; é€šè¿‡createAdaptiveExtensionClassCodeåˆ›å»ºå®ç°ç±»çš„ä»£ç å¦‚ä¸‹ï¼Œä¸ºäº†æ–¹ä¾¿é˜…è¯»æŠŠå…¨ç±»åä¿®æ”¹æˆç®€å•çš„ç±»åã€‚å¯ä»¥æ–­ç‚¹åˆ°createAdaptiveExtensionClassä¸­æŸ¥çœ‹codeå˜é‡å€¼ã€‚ 12345678910111213141516171819package com.alibaba.dubbo.common.extensionloader.ext6_inject;import com.alibaba.dubbo.common.extension.ExtensionLoader;public class Ext6$Adaptive implements Ext6 &#123; public java.lang.String echo(URL arg0, java.lang.String arg1) &#123; if (arg0 == null) &#123; throw new IllegalArgumentException(\"url == null\"); &#125; URL url = arg0; String extName = url.getParameter(\"ext6\"); if(extName == null) &#123; throw new IllegalStateException(\"Fail to get extension(Ext6) name from url(\" + url.toString() + \") use keys([ext6])\"); &#125; Ext6 extension = ExtensionLoader.getExtensionLoader(Ext6.class).getExtension(extName); return extension.echo(arg0, arg1); &#125;&#125; é€šè¿‡codeå€¼å°±èƒ½å¤§ä½“çœ‹å‡ºæ¥createAdaptiveExtensionClassCodeæ–¹æ³•åšäº†å•¥äº‹ã€‚è€Œåå¯¹è¿™ä¸ªExt6$Adaptiveç±»åŠ è½½å®ä¾‹åŒ–èµ‹å€¼ç»™æµ‹è¯•ä»£ç ç¬¬5è¡Œçš„extå˜é‡ã€‚ç´§æ¥ç€èµ°åˆ°ç¬¬10è¡Œï¼Œæ‰§è¡Œextçš„echo()ã€‚è‡ªé€‚åº”åŠ è½½è¿‡ç¨‹ä¸­ï¼Œé…ç½®ä¿¡æ¯å…¨éƒ¨æ”¾åœ¨urlä¸­ï¼Œé€šè¿‡urlå˜é‡è¿›è¡Œæ§åˆ¶ã€‚å…¶å®çœŸå®æ‰§è¡Œçš„å®ç°ç±»çš„ä¸‹é¢è¿™å¥ä»£ç ï¼š 1Ext6 extension = ExtensionLoader.getExtensionLoader(Ext6.class).getExtension(url.getParameter(\"ext6\")); å› ä¸ºæˆ‘ä»¬urlä¸­â€ext6â€çš„å‚æ•°å€¼â€impl1â€ï¼Œæ‰€ä»¥å…¶å®å®ç°ç±»å°±æ˜¯com.alibaba.dubbo.common.extensionloader.ext6_inject.impl.Ext6Impl1ã€‚åœ¨åˆ›å»ºçš„è¿‡ç¨‹ä¸­éœ€è¦è°ƒç”¨ injectExtension æ–¹æ³•å‘æ‹“å±•å®ä¾‹ä¸­æ³¨å…¥ä¾èµ–ï¼Œçœ‹ä¸€ä¸‹ Ext6Impl1 çš„å®šä¹‰ï¼Œå­˜åœ¨ setExt1 å’Œ setDao ä¸¤ä¸ªæ–¹æ³•ã€‚æ³¨å…¥çš„ä¸»è¦å®ç°é€šè¿‡objectFactory.getExtension(pt, property) ã€‚ 1234567891011121314&#x2F;&#x2F; com.alibaba.dubbo.common.extension.ExtensionLoader#injectExtensionClass&lt;?&gt; pt &#x3D; method.getParameterTypes()[0];try &#123; String property &#x3D; method.getName().length() &gt; 3 ? method.getName().substring(3, 4).toLowerCase() + method.getName().substring(4) : &quot;&quot;; Object object &#x3D; objectFactory.getExtension(pt, property);è¿›è¡Œæ³¨å…¥ï¼Œ if (object !&#x3D; null) &#123; method.invoke(instance, object); &#125;&#125; catch (Exception e) &#123; logger.error(&quot;fail to inject via method &quot; + method.getName() + &quot; of interface &quot; + type.getName() + &quot;: &quot; + e.getMessage(), e);&#125; objectFactoryé»˜è®¤å®ç°æ˜¯AdaptiveExtensionFactoryï¼Œä½†æ˜¯é€šè¿‡å…¶æˆå‘˜å˜é‡factoriesä¾æ¬¡è¿›è¡ŒåŠ è½½ï¼Œé»˜è®¤æ˜¯SpiExtensionFactoryåŠ è½½è¢«@SPIæ³¨è§£ä¿®æ”¹çš„ç±»å‹ã€‚æ‰€ä»¥Ext6Impl1ä¸­çš„æˆå‘˜å˜é‡SimpleExt ext1ä¼šè¢«åŠ è½½ã€‚ åŠ è½½çš„æ—¶å€™å› ä¸º SimpleExt çš„å®ç°ç±»éƒ½æ²¡æœ‰å¸¦æœ‰ @Adaptive æ³¨è§£ï¼Œæ‰€ä»¥åƒ Ext6$Adaptive å½¢å¼åŠ è½½ã€‚ä½†æ˜¯å› ä¸º SimpleExt æ¥å£å®šä¹‰çš„æ—¶å€™æ–¹æ³•ä½¿ç”¨ @Adaptiveï¼Œæ‰€ä»¥ç”Ÿæˆçš„ä»£ç é€»è¾‘æ¯” Ext6$Adaptive å¤æ‚ã€‚``java@SPI(â€œimpl1â€)public interface SimpleExt { // @Adaptive example, do not specify a explicit key. @Adaptive String echo(URL url, String s); @Adaptive({&quot;key1&quot;, &quot;key2&quot;}) String yell(URL url, String s); // no @Adaptive String bang(URL url, int i);} 1234567891011121314151617181920212223242526272829303132333435&#96;&#96;&#96;javapackage com.alibaba.dubbo.common.extensionloader.ext1;import com.alibaba.dubbo.common.extension.ExtensionLoader;public class SimpleExt$Adaptive implements SimpleExt &#123; public String echo(URL arg0, String arg1) &#123; if (arg0 &#x3D;&#x3D; null) throw new IllegalArgumentException(&quot;url &#x3D;&#x3D; null&quot;); URL url &#x3D; arg0; String extName &#x3D; url.getParameter(&quot;simple.ext&quot;, &quot;impl1&quot;); if (extName &#x3D;&#x3D; null) throw new IllegalStateException(&quot;Fail to get extension(SimpleExt) name from url(&quot; + url.toString() + &quot;) use keys([simple.ext])&quot;); SimpleExt extension &#x3D; (SimpleExt) ExtensionLoader.getExtensionLoader(SimpleExt.class).getExtension(extName); return extension.echo(arg0, arg1); &#125; public String yell(URL arg0, String arg1) &#123; if (arg0 &#x3D;&#x3D; null) throw new IllegalArgumentException(&quot;url &#x3D;&#x3D; null&quot;); URL url &#x3D; arg0; String extName &#x3D; url.getParameter(&quot;key1&quot;, url.getParameter(&quot;key2&quot;, &quot;impl1&quot;)); if (extName &#x3D;&#x3D; null) throw new IllegalStateException(&quot;Fail to get extension(SimpleExt) name from url(&quot; + url.toString() + &quot;) use keys([key1, key2])&quot;); SimpleExt extension &#x3D; (SimpleExt) ExtensionLoader.getExtensionLoader(SimpleExt.class).getExtension(extName); return extension.yell(arg0, arg1); &#125; public String bang(URL arg0, int arg1) &#123; throw new UnsupportedOperationException(&quot;method public abstract String SimpleExt.bang(URL,int) of interface SimpleExt is not adaptive method!&quot;); &#125;&#125; å®ç°å¸¦æœ‰åˆ¶å®šçš„é»˜è®¤å€¼ï¼Œå‚æ•°çš„è®¾ç½®ä¹Ÿæ˜¯æœ‰è§„åˆ™çš„ï¼Œæ‰€ä»¥å»ºè®®é˜…è¯» createAdaptiveExtensionClassCode æ–¹æ³•ï¼Œé˜…è¯»çš„æ—¶å€™å‚è€ƒå¼€å¤´æ¨èçš„å®˜ç½‘æºç å°±å¾ˆç®€å•ã€‚ æœ€åæ„é€ å¥½å®ä¾‹æ‰§è¡Œ echo æ–¹æ³•ã€‚ è¿™é‡Œå°±å¯ä»¥çœ‹å‡ºæ¥URLçš„ä½œç”¨ï¼Œç›¸å½“äºæ•°æ®æ€»çº¿ï¼Œé€šè¿‡å…¶ç»‘å®šé…ç½®ä¿¡æ¯ æ€»ç»“ åæœŸè¡¥ä¸Š ç›®çš„ å¦‚ä½•è®¾è®¡ å¦‚ä½•å®ç° ä¼˜ç¼ºç‚¹ ç†Ÿæ‚‰ ExtensionLoader.getExtensionLoader(type) è¿™ç§ä¿„ç½—æ–¯å¥—å¨ƒå¼çš„åŠ è½½ã€‚","categories":[],"tags":[{"name":"æºç é˜…è¯»","slug":"æºç é˜…è¯»","permalink":"http://bannong.wang/tags/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/"},{"name":"Dubbo","slug":"Dubbo","permalink":"http://bannong.wang/tags/Dubbo/"}]},{"title":"ä¸ªäººåšå®¢æ­å»º","slug":"Blog","date":"2020-06-18T08:31:44.753Z","updated":"2020-12-03T13:44:37.006Z","comments":true,"path":"2020/06/18/Blog/","link":"","permalink":"http://bannong.wang/2020/06/18/Blog/","excerpt":"","text":"ğŸ“°æœ¬åšå®¢é‡‡ç”¨Hexoï¼Œèµ„æºç›´æ¥æ‰˜ç®¡åœ¨Githubã€‚âš™ï¸å…³äºå¦‚æœæ“ä½œï¼ŒHexoå·²ç»æä¾›æ–‡æ¡£ï¼Œè‡ªå·±æœç´¢ğŸ”ä¹Ÿè¡Œï¼Œè¿™é¢æ¨ècofessä¸»é¢˜ä½œè€…çš„ä¸€ç¯‡æ–‡ç« ã€‚ å¤‡å¿˜å…³é”®æ“ä½œ1234567891011121314# hexo new \"æˆ‘çš„åšå®¢\"$ hexo n \"æˆ‘çš„åšå®¢\"# clean$ hexo clean# hexo generate ç”Ÿæˆé™æ€é¡µé¢$ hexo g# hexo server å¯åŠ¨æœåŠ¡é¢„è§ˆ$ hexo s# hexo deploy éƒ¨ç½²$ hexo d","categories":[],"tags":[]}],"categories":[],"tags":[{"name":"æºç é˜…è¯»","slug":"æºç é˜…è¯»","permalink":"http://bannong.wang/tags/%E6%BA%90%E7%A0%81%E9%98%85%E8%AF%BB/"},{"name":"Dubbo","slug":"Dubbo","permalink":"http://bannong.wang/tags/Dubbo/"}]}